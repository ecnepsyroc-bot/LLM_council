openapi: 3.1.0
info:
  title: LLM Council API
  description: Multi-LLM deliberation system
  version: 1.0.0
paths:
  /health:
    get:
      tags:
      - Health
      summary: Health Check
      description: Basic liveness check.
      operationId: health_check_health_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
  /health/ready:
    get:
      tags:
      - Health
      summary: Readiness Check
      description: Readiness check for load balancers.
      operationId: readiness_check_health_ready_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReadinessResponse'
  /:
    get:
      summary: Root
      description: Root endpoint.
      operationId: root__get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /api/conversations:
    get:
      summary: List Conversations
      description: List all conversations (metadata only).
      operationId: list_conversations_api_conversations_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/ConversationMetadata'
                type: array
                title: Response List Conversations Api Conversations Get
    post:
      summary: Create Conversation
      description: Create a new conversation.
      operationId: create_conversation_api_conversations_post
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConversationRequest'
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/config:
    get:
      summary: Get Config
      description: Get council configuration.
      operationId: get_config_api_config_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /api/conversations/{conversation_id}:
    get:
      summary: Get Conversation
      description: Get a specific conversation with all its messages.
      operationId: get_conversation_api_conversations__conversation_id__get
      parameters:
      - name: conversation_id
        in: path
        required: true
        schema:
          type: string
          title: Conversation Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
    patch:
      summary: Update Conversation
      description: Update conversation fields (title, pin, hide).
      operationId: update_conversation_api_conversations__conversation_id__patch
      parameters:
      - name: conversation_id
        in: path
        required: true
        schema:
          type: string
          title: Conversation Id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateConversationRequest'
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
    delete:
      summary: Delete Conversation
      description: Delete a conversation.
      operationId: delete_conversation_api_conversations__conversation_id__delete
      parameters:
      - name: conversation_id
        in: path
        required: true
        schema:
          type: string
          title: Conversation Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/conversations/{conversation_id}/message:
    post:
      summary: Send Message
      description: Send a message and run the 3-stage council process.
      operationId: send_message_api_conversations__conversation_id__message_post
      parameters:
      - name: conversation_id
        in: path
        required: true
        schema:
          type: string
          title: Conversation Id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendMessageRequest'
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/conversations/{conversation_id}/message/stream:
    post:
      summary: Send Message Stream
      description: Send a message and stream the 3-stage council process.
      operationId: send_message_stream_api_conversations__conversation_id__message_stream_post
      parameters:
      - name: conversation_id
        in: path
        required: true
        schema:
          type: string
          title: Conversation Id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendMessageRequest'
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
components:
  schemas:
    Conversation:
      properties:
        id:
          type: string
          title: Id
        created_at:
          type: string
          title: Created At
        title:
          type: string
          title: Title
        is_pinned:
          type: boolean
          title: Is Pinned
          default: false
        is_hidden:
          type: boolean
          title: Is Hidden
          default: false
        messages:
          items:
            additionalProperties: true
            type: object
          type: array
          title: Messages
      type: object
      required:
      - id
      - created_at
      - title
      - messages
      title: Conversation
      description: Full conversation with all messages.
    ConversationMetadata:
      properties:
        id:
          type: string
          title: Id
        created_at:
          type: string
          title: Created At
        updated_at:
          type: string
          title: Updated At
          default: ''
        title:
          type: string
          title: Title
        is_pinned:
          type: boolean
          title: Is Pinned
          default: false
        is_hidden:
          type: boolean
          title: Is Hidden
          default: false
        message_count:
          type: integer
          title: Message Count
          default: 0
      type: object
      required:
      - id
      - created_at
      - title
      title: ConversationMetadata
      description: Conversation metadata for list view.
    CreateConversationRequest:
      properties: {}
      type: object
      title: CreateConversationRequest
      description: Request to create a new conversation.
    DeliberationOptions:
      properties:
        voting_method:
          type: string
          title: Voting Method
          default: borda
        use_rubric:
          type: boolean
          title: Use Rubric
          default: false
        debate_rounds:
          type: integer
          title: Debate Rounds
          default: 1
        enable_early_exit:
          type: boolean
          title: Enable Early Exit
          default: true
        rotating_chairman:
          type: boolean
          title: Rotating Chairman
          default: false
      type: object
      title: DeliberationOptions
      description: Options for the deliberation process.
    HTTPValidationError:
      properties:
        detail:
          items:
            $ref: '#/components/schemas/ValidationError'
          type: array
          title: Detail
      type: object
      title: HTTPValidationError
    HealthResponse:
      properties:
        status:
          type: string
          title: Status
        timestamp:
          type: string
          title: Timestamp
      type: object
      required:
      - status
      - timestamp
      title: HealthResponse
    ReadinessResponse:
      properties:
        status:
          type: string
          title: Status
        timestamp:
          type: string
          title: Timestamp
        checks:
          additionalProperties: true
          type: object
          title: Checks
      type: object
      required:
      - status
      - timestamp
      - checks
      title: ReadinessResponse
    SendMessageRequest:
      properties:
        content:
          type: string
          title: Content
        images:
          items:
            type: string
          type: array
          title: Images
          default: []
        options:
          anyOf:
          - $ref: '#/components/schemas/DeliberationOptions'
          - type: 'null'
      type: object
      required:
      - content
      title: SendMessageRequest
      description: Request to send a message in a conversation.
    UpdateConversationRequest:
      properties:
        title:
          anyOf:
          - type: string
          - type: 'null'
          title: Title
        is_pinned:
          anyOf:
          - type: boolean
          - type: 'null'
          title: Is Pinned
        is_hidden:
          anyOf:
          - type: boolean
          - type: 'null'
          title: Is Hidden
      type: object
      title: UpdateConversationRequest
      description: Request to update conversation fields.
    ValidationError:
      properties:
        loc:
          items:
            anyOf:
            - type: string
            - type: integer
          type: array
          title: Location
        msg:
          type: string
          title: Message
        type:
          type: string
          title: Error Type
      type: object
      required:
      - loc
      - msg
      - type
      title: ValidationError
